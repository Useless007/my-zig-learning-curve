
# การอธิบายโปรแกรมคำนวณ BMI ด้วยภาษา Zig

โปรแกรมนี้เป็นโปรแกรมคำนวณค่าดัชนีมวลกาย (BMI) โดยรับข้อมูลน้ำหนักและส่วนสูงจากผู้ใช้ และแสดงผลลัพธ์พร้อมคำแปลผล BMI เป็นภาษาไทย

---

## โครงสร้างของโปรแกรม

โปรแกรมนี้ประกอบด้วยฟังก์ชันหลักดังนี้:

1. **`calBmi`**: ฟังก์ชันสำหรับคำนวณค่า BMI
2. **`interpretBmi`**: ฟังก์ชันสำหรับแปลผล BMI
3. **`readUserInput`**: ฟังก์ชันสำหรับรับข้อมูลจากผู้ใช้และคำนวณ BMI
4. **`main`**: ฟังก์ชันหลักที่เรียกใช้งานโปรแกรม

---

## การอธิบายโค้ดโดยละเอียด

### การนำเข้า Standard Library (`std`)

```zig
const std = @import("std");
const print = std.debug.print;
const stdin = std.io.getStdIn().reader();
const stdout = std.io.getStdOut().writer();
```

- **`std`**: เป็น Standard Library ของภาษา Zig ที่มีฟังก์ชันพื้นฐานต่าง ๆ เช่น การจัดการ I/O, การจัดการหน่วยความจำ, และการจัดรูปแบบข้อความ
- **`std.debug.print`**: ใช้สำหรับพิมพ์ข้อความไปยังหน้าจอ (stdout)
- **`std.io.getStdIn().reader()`**: ใช้สำหรับอ่านข้อมูลจากผู้ใช้ผ่านทางคีย์บอร์ด (stdin)
- **`std.io.getStdOut().writer()`**: ใช้สำหรับเขียนข้อมูลไปยังหน้าจอ (stdout)

Standard Library มีความสำคัญเพราะช่วยให้เราสามารถจัดการ I/O และการประมวลผลข้อมูลได้ง่ายขึ้นโดยไม่ต้องเขียนโค้ดซับซ้อนเอง

---

### ฟังก์ชัน `calBmi`

```zig
fn calBmi(weight: f32, height: f32) f32 {
    return weight / (height * height);
}
```

- ฟังก์ชันนี้คำนวณ BMI โดยใช้สูตร:
  ```
  BMI = น้ำหนัก (kg) / (ส่วนสูง (m))^2
  ```
- รับพารามิเตอร์:
  - `weight`: น้ำหนักของผู้ใช้ในหน่วยกิโลกรัม (kg)
  - `height`: ส่วนสูงของผู้ใช้ในหน่วยเมตร (m)
- คืนค่าผลลัพธ์เป็นค่า BMI ชนิด `f32`

---

### ฟังก์ชัน `interpretBmi`

```zig
fn interpretBmi(bmi: f32) []const u8 {
    if (bmi < 18.5) {
        return "น้ำหนักต่ำกว่าเกณฑ์";
    } else if (bmi < 25.0) {
        return "น้ำหนักปกติ";
    } else if (bmi < 30.0) {
        return "น้ำหนักเกิน";
    } else {
        return "อ้วน";
    }
}
```

- ฟังก์ชันนี้แปลผล BMI เป็นข้อความภาษาไทยตามเกณฑ์ดังนี้:
  - BMI < 18.5: น้ำหนักต่ำกว่าเกณฑ์
  - 18.5 ≤ BMI < 25.0: น้ำหนักปกติ
  - 25.0 ≤ BMI < 30.0: น้ำหนักเกิน
  - BMI ≥ 30.0: อ้วน
- รับพารามิเตอร์:
  - `bmi`: ค่าดัชนีมวลกายที่คำนวณได้
- คืนค่าข้อความภาษาไทยเป็นชนิด `[]const u8`

---

### ฟังก์ชัน `readUserInput`

```zig
fn readUserInput() !void {
    var buf: [100]u8 = undefined;
    ...
}
```

ฟังก์ชันนี้มีหน้าที่รับข้อมูลจากผู้ใช้และคำนวณ BMI โดยมีขั้นตอนดังนี้:

#### การสร้าง Buffer (`buf`)

```zig
var buf: [100]u8 = undefined;
```

- **`buf`**: เป็นอาร์เรย์ของชนิดข้อมูล `u8` (unsigned 8-bit integer) ที่ใช้เป็น buffer สำหรับเก็บข้อมูลที่ผู้ใช้ป้อนเข้ามา
- ขนาดของ buffer ถูกกำหนดเป็น 100 ไบต์ ซึ่งเพียงพอสำหรับการรับข้อมูลข้อความสั้น ๆ เช่น น้ำหนักและส่วนสูง

#### การใช้ `readUntilDelimiterOrEof`

```zig
const weight_input = try stdin.readUntilDelimiterOrEof(&buf, '\n');
```

- **`readUntilDelimiterOrEof`**: เป็นฟังก์ชันที่อ่านข้อมูลจาก stdin จนกว่าจะเจอ delimiter (ในที่นี้คือ `'\n'`) หรือจนกว่าจะถึงจุดสิ้นสุดของไฟล์ (EOF)
- ฟังก์ชันนี้ช่วยให้เราสามารถอ่านข้อมูลทีละบรรทัดได้อย่างสะดวก

#### การใช้ `.?.` ใน Zig

```zig
if (weight_input == null or weight_input.?.len == 0) {
    return error.InvalidInput;
}
```

- **`.?.`**: เป็น syntax ของ Zig ที่ใช้สำหรับการเข้าถึงค่าของ optional type
  - ถ้าค่าเป็น `null` จะไม่สามารถเข้าถึงได้ และจะเกิดข้อผิดพลาด
  - ถ้าค่าไม่เป็น `null` จะสามารถเข้าถึงค่าภายในได้
- ในตัวอย่างนี้ `weight_input.?.len` ใช้ตรวจสอบความยาวของข้อความที่ผู้ใช้ป้อนเข้ามา

#### การแปลงข้อมูลจากข้อความเป็นตัวเลข

```zig
const weight = try std.fmt.parseFloat(f32, weight_input.?);
```

- **`std.fmt.parseFloat`**: เป็นฟังก์ชันที่ใช้แปลงข้อความ (string) ให้เป็นตัวเลขชนิด `f32` (floating-point 32-bit)
- การใช้ `try` ช่วยจัดการข้อผิดพลาดในกรณีที่ข้อความไม่สามารถแปลงเป็นตัวเลขได้

#### การแปลงหน่วยจากเซนติเมตรเป็นเมตร

```zig
const height_m = height_cm / 100.0;
```

- ส่วนสูงที่ผู้ใช้ป้อนเข้ามาเป็นเซนติเมตร (cm) แต่ในการคำนวณ BMI ต้องใช้หน่วยเป็นเมตร (m)
- การแปลงหน่วยทำได้โดยการหารค่าที่ป้อนเข้ามาด้วย 100

---

### ฟังก์ชัน `main`

```zig
pub fn main() !void {
    print("โปรแกรมคำนวณ BMI\n", .{});
    print("-----------------\n", .{});
  
    readUserInput() catch |err| {
        print("\nเกิดข้อผิดพลาด: {}\n", .{err});
        print("โปรดกรอกข้อมูลให้ถูกต้อง\n", .{});
    };
}
```

- ฟังก์ชัน `main` เป็นจุดเริ่มต้นของโปรแกรม
- เรียกใช้ฟังก์ชัน `readUserInput` เพื่อรับข้อมูลและคำนวณ BMI
- ใช้ `catch` เพื่อจัดการข้อผิดพลาดที่อาจเกิดขึ้น

---

## ตัวอย่างการใช้งาน

### Input:

```
Enter your weight (kg): 70
Enter your height (cm): 170
```

### Output:

```
น้ำหนัก: 70.0 kg
ส่วนสูง: 170.0 cm (1.70 m)
BMI: 24.22
ผลลัพธ์: น้ำหนักปกติ
```

---

## ข้อควรระวัง

- ผู้ใช้ต้องป้อนข้อมูลที่เป็นตัวเลขเท่านั้น หากป้อนข้อมูลผิดพลาด โปรแกรมจะแสดงข้อความแจ้งเตือน
- ข้อมูลส่วนสูงต้องป้อนเป็นเซนติเมตร และข้อมูลน้ำหนักต้องป้อนเป็นกิโลกรัม

---

## สรุป

โปรแกรมนี้แสดงให้เห็นถึงการใช้งานภาษา Zig ในการจัดการ I/O, การคำนวณ, และการจัดการข้อผิดพลาดอย่างมีประสิทธิภาพ โดยใช้ฟังก์ชันจาก Standard Library เช่น `std.io` และ `std.fmt` เพื่อช่วยลดความซับซ้อนของโค้ด
